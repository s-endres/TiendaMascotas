@{
    ViewBag.Title = "ProductType";
}

<h2>Product Type</h2>
<!DOCTYPE HTML>
<html>
<head>
    <!-- MetisMenu CSS -->
    <link href="/bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="/bower_components/datatables-plugins/integration/bootstrap/3/dataTables.bootstrap.css" rel="stylesheet">
    <!-- DataTables Responsive CSS -->
    <link href="/bower_components/datatables-responsive/css/dataTables.responsive.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="/bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- DataTables JavaScript -->
    <script src="/bower_components/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="/bower_components/datatables-plugins/integration/bootstrap/3/dataTables.bootstrap.min.js"></script>
    <link href="/bower_components/select2/css/select2.min.css" rel="stylesheet" type="text/css">
    <script src="/bower_components/select2/js/select2.min.js"></script>
    <!-- Summernote -->
    <link href="/bower_components/summernote/css/summernote.css" rel="stylesheet" type="text/css">
    <script src="/bower_components/summernote/js/summernote.min.js"></script>
</head>
<body>
    <script>
        $(document).ready(function () {

            $.ajax({
                type: "GET",
                url: "http://localhost:58176/ProductType/GetAllTypes",
                data: "",
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                success: function (pData) {
                    $Table = $("#MainTable").DataTable({
                        "processing": true,
                        "data": pData,
                        "columns": [
                            { "data": "Id" },
                            { "data": "TypeName" },
                            { "defaultContent": "<span class='glyphicon glyphicon-remove-circle'></span> |" + " <span class='glyphicon glyphicon-ok-circle'></span> |" + " <span class='glyphicon glyphicon-unchecked'></span>" }
                        ],
                        responsive: true
                    });//Inicialize the Data Table
                },
                error: function () {
                    alert("Jaja salu2");
                }
            });//Close GET Ajax

            $.ajax({
                type: "GET",
                url: "http://localhost:58176/Category/GetAllCategories",
                data: "",
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                success: function (pData) {
                    if (pData) {

                        $.each(pData, function () {
                            $("#SelectCategory").append('<option value="' + this.Id + '">' + this.Name + '</option>');
                        });
                    }
                    else {

                        if (!$('div[class="alert-danger"]').length) {
                            $(".form-group").prepend('<div class="alert alert-danger"><strong>Omaiga!</strong>Something went wrong</div>');
                        }
                    }
                },
                error: function () {
                    WarningMessage();
                }
            });//Close Ajax GET Categories

            $("#AddType").click(function () {
                $.ajax({
                    type: "POST",
                    url: "http://localhost:58176/ProductType/AddNewProductType",
                    data: JSON.stringify({
                        TypeName: $("#TypeName").val(),
                        IdCategory: $("#SelectCategory").val()
                    }),
                    dataType: "json",
                    contentType: 'application/json; charset=utf-8',
                    success: function (pData) {
                        var ObjPost = {
                            Id: pData.Id,
                            TypeName: $("#TypeName").val(),
                            IdCategory: $("#SelectCategory").val()
                        };
                        console.log(ObjPost);
                        $Table
                            .row
                            .add(ObjPost)
                            .draw();
                        CloseModal();
                    },
                    error: function () {
                    }
                });//Close POST Ajax
            });

            $("tbody").on("click", ".glyphicon-ok-circle", function () {
                var Row = $(this).parents("tr")
                var Index = $Table.row(Row).index();
                var Data = $Table.row(Index).data();
                console.log(Data);

            })


        });//Close Document Ready


        /*************************************FUNCTIONS AREA*************************************/
        function OpenModal()
        {
            $("#myModal").modal();
            $(".IdDiv").css("display", "none");
            $("#EditRow").css("display", "none");

        }

        function CloseModal()
        {
            $("#myModal").modal("hide");
        }
    </script>
    <style>
        #hidden {
            display:none;
        }
    </style>


    <!------------------------------------------MAIN TABLE------------------------------------------>
    Add New Product Type | <span><button id="AddTypeModal" class="btn btn-success btn btn-default glyphicon glyphicon-plus-sign" type="button" onclick="OpenModal()"></button></span>
    <table id="MainTable" class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>
                    <label>Id</label>
                </th>
                <th>
                    <label>Type Name</label>
                </th>
                <th>
                    <label>Buttons</label>
                </th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <!------------------------------------------MAIN TABLE------------------------------------------>
    <!------------------------------------------MODAL------------------------------------------>
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header" style="padding:35px 50px;">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4><span class="glyphicon glyphicon-add"></span>Add a new Product</h4>
                </div>
                <div class="modal-body ValidationModal" id="modal-body" style="padding:40px 50px;">

                    <form role="form">

                        <div class="form-group IdDiv">
                            <label for="usrname"><span class="glyphicon glyphicon-user"></span> Id</label>
                            <input type="text" class="form-control NewOne" id="Id" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="usrname"><span class="glyphicon glyphicon-user"></span>Type Name</label>
                            <input type="text" class="form-control ClassName" id="TypeName" placeholder="Enter Name of the product">
                        </div>
                        <input type="text" id="hidden">
                    </form>
                    <div class="form-group">
                        <label for="usrname"><span class="glyphicon glyphicon-user"></span>Categories</label>
                        <select class="form-control" id="SelectCategory"></select>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-success btn-block" id="AddType"><span class="glyphicon glyphicon-record"></span> Add New Type</button>
                    <button type="submit" class="btn btn-success btn-block Display" id="EditRow"><span class="glyphicon glyphicon-record"></span> Edit Product Type</button>
                    <button type="submit" class="btn btn-success btn-block" id="CloseModal" onclick="CloseModal()"><span class="glyphicon glyphicon-remove-circle"></span> Cancel </button>
                </div>
            </div>


        </div>
    </div>
    <!------------------------------------------MODAL------------------------------------------>


</body>
</html>








